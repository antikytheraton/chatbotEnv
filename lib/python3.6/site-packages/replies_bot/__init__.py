class RepliesBot(object):

	def __init__(self,bot):
		self.bot = bot
		self.buttons = {'state7':[{"type":"phone_number","title":"DF y área metropolitana","payload": "54478810" }, 
						  {"type":"phone_number","title":"Lada sin costo","payload": "018000407777" }],
			   'state10':[{"type":"postback","title":"Enviar dinero","payload": 50 }, 
						  {"type":"postback","title":"Localiza sucursales cernacas","payload": 999 },
						  {"type":"postback","title":"Ayuda","payload": 30 }],
			   'state30':[{"type":"postback","title":"Contactar","payload": 6 },
						  {"type":"postback","title":"Términos y condiciones","payload": 40 },],
			   'state210':[{"type":"phone_number","title":"Llamar","payload": "+525500000000" }, 
						  {"type":"phone_number","title":"Escribir correo","payload": "+525500000000" }],
			   'state70':[{"type":"postback","title":"Seleccionar beneficiario","payload": 80 }, 
						  {"type":"postback","title":"Nuevo beneficiario","payload": 60 }],}
		self.replies = {'state90':[{"content_type":"text","title":"$200","payload":"200"}, 
						  {"content_type":"text","title":"$500","payload":"500"}, 
						  {"content_type":"text","title":"$1000","payload":"1000"}],
				'stateS/N':[{"content_type":"text","title":"Si","payload":"Si"}, 
						  {"content_type":"text","title":"No","payload":"No"}],
				'state190':[{"content_type":"location", "title":"Enviar"},
							{"content_type":"text","title":"No enviar","payload":"No_location"}],
				'state85':[{"content_type":"text","title":"A-C","payload":"1"}, 
						  {"content_type":"text","title":"D-M","payload":"2"}, 
						  {"content_type":"text","title":"N-S","payload":"3"},
						  {"content_type":"text","title":"T-Z","payload":"4"}],
				'state_area_1':[{"content_type":"text","title":"Aguascalientes","payload":"Aguascalientes"}, 
						  {"content_type":"text","title":"Baja California","payload":"Baja California"}, 
						  {"content_type":"text","title":"Baja California Sur","payload":"Baja California Sur"},
						  {"content_type":"text","title":"Campeche","payload":"Campeche"},
						  {"content_type":"text","title":"Chiapas","payload":"Chiapas"}, 
						  {"content_type":"text","title":"Chihuahua","payload":"Chihuahua"}, 
						  {"content_type":"text","title":"Coahuila","payload":"Coahuila"},
						  {"content_type":"text","title":"Colima","payload":"Colima"},
						  {"content_type":"text","title":"Volver","payload":"back"}],
				'state_area_2':[{"content_type":"text","title":"Distrito Federal","payload":"DISTRITO FEDERAL"},
						  {"content_type":"text","title":"Durango","payload":"Durango"}, 
						  {"content_type":"text","title":"Estado de México","payload":"Mexico"}, 
						  {"content_type":"text","title":"Guanajuato","payload":"Guanajuato"},
						  {"content_type":"text","title":"Guerrero","payload":"Guerrero"}, 
						  {"content_type":"text","title":"Hidalgo","payload":"Hidalgo"},
						  {"content_type":"text","title":"Jalisco","payload":"Jalisco"}, 
						  {"content_type":"text","title":"Michoacán","payload":"Michoacan"},
						  {"content_type":"text","title":"Morelos","payload":"Morelos"},
						  {"content_type":"text","title":"Volver","payload":"back"}],
				'state_area_3':[{"content_type":"text","title":"Nayarit","payload":"Nayarit"}, 
						  {"content_type":"text","title":"Nuevo León","payload":"Nuevo Leon"}, 
						  {"content_type":"text","title":"Oaxaca","payload":"Oaxaca"},
						  {"content_type":"text","title":"Puebla","payload":"Puebla"},
						  {"content_type":"text","title":"Querétaro","payload":"Queretaro"}, 
						  {"content_type":"text","title":"Quintana Roo","payload":"Quintana Roo"},
						  {"content_type":"text","title":"San Luis Potosí","payload":"San Luis Potosi"}, 
						  {"content_type":"text","title":"Sinaloa","payload":"Sinaloa"},
						  {"content_type":"text","title":"Sonora","payload":"Sonora"},
						  {"content_type":"text","title":"Volver","payload":"back"}],
				'state_area_4':[{"content_type":"text","title":"Tabasco","payload":"Tabasco"}, 
						  {"content_type":"text","title":"Tamaulipas","payload":"Tamaulipas"}, 
						  {"content_type":"text","title":"Tlaxcala","payload":"Tlaxcala"},
						  {"content_type":"text","title":"Veracruz","payload":"Veracruz"},
						  {"content_type":"text","title":"Yucatán","payload":"Yucatan"}, 
						  {"content_type":"text","title":"Zacatecas","payload":"Zacatecas"}, 
						  {"content_type":"text","title":"Volver","payload":"back"}],}



	def state_location(self,sender_id,coordinates):
		message = "Enviaste localización"
		self.bot.send_text_message(sender_id, message)

	def send_alert(self,sender_id, message):
		'''Alert'''
		self.bot.send_text_message(sender_id, message)

	def state_verify_states(self,sender_id,state):
		text = "El estado es " + state
		self.bot.send_quick_replies(sender_id,text,self.replies['stateS/N'])


	def state_verify(self,sender_id, names):
		'''Verify names'''
		text = "Confirma el nombre\nNombre(s): "+names[0]+"\nApellido paterno: "+names[1]+"\nApellido materno: "+names[2]
		self.bot.send_quick_replies(sender_id,text,self.replies['stateS/N'])

	def state_verify_address(self,sender_id, street):
		'''Verify steeet'''
		text = "Confirma la dirección\nCalle: "+street['calle_num']+"\nColonia: "+street['colonia']+"\nCodigo Postal: "+street['codigo_postal']
		self.bot.send_quick_replies(sender_id,text,self.replies['stateS/N'])

	def show_yes_no(self,sender_id, text):
		'''Verify names'''
		self.bot.send_quick_replies(sender_id,text,self.replies['stateS/N'])

	def state_verify_date(self,sender_id,name,date):
		text = name+", tu fecha de nacimiento es "+ date
		self.bot.send_quick_replies(sender_id,text,self.replies['stateS/N'])

	def state_restart(self, sender_id, name):
		'''Reinicio del bot'''
		text = "¿Te puedo ayudar con algo más "+name+" ?"
		self.bot.send_button_message(sender_id, text, self.buttons['state10'])

	def state_menu(self, sender_id, text):
		'''Respuesta rápida para enviar dinero'''
		self.bot.send_quick_replies(sender_id, text, self.replies['state_MP'])

	def state_exit(self, sender_id, name):
		'''Despedida del bot'''
		message = "Estaré aquí por si me necesitas "+name+" :)"
		self.bot.send_text_message(sender_id, message)

	def state_5(self, sender_id):
		'''Cancelar operación'''
		message = "Operación cancelada"
		self.bot.send_text_message(sender_id, message)

	def state_6(self, sender_id):
		'''Tutorial'''
		message = "Tutorial"
		self.bot.send_text_message(sender_id, message)

	def state_7(self, sender_id,):
		'''Contacto'''
		text = "Centro de antención a clientes"
		self.bot.send_button_message(sender_id, text, self.buttons['state7'])

	def state_10(self,sender_id, name):
		'''Presentación bot'''
		message = "Hola "+name+", bienvenido a Dinero Express"
		self.bot.send_text_message(sender_id, message)
		message = "Es el servicio que te permite enviar dinero a cualquier persona sin la necesidad de una cuenta bancaria"
		self.bot.send_text_message(sender_id,message)
		text = "¿En que te podemos ayudar?"
		self.bot.send_button_message(sender_id, text, self.buttons['state10'])

	def state_30(self,sender_id):
		'''Opciones de ayuda'''
		text = "¿Cómo puedo ayudarte?"
		self.bot.send_button_message(sender_id, text, self.buttons['state30'])

	def state_40(self,sender_id):
		'''Términos y condiciones, Políticas de privacidad'''
		elements = [{"title":"Términos y condiciones", 
					"item_url":"http://www.google.com",
				  	"image_url":"http://learexpress.com/venezuela/wp-content/themes/lear_express_wp/images/terminos-y-condiciones.png"},
					{"title":"Políticas de privacidad", 
					"item_url":"http://www.google.com",
				  	"image_url":"http://learexpress.com/venezuela/wp-content/themes/lear_express_wp/images/terminos-y-condiciones.png"}]
		self.bot.send_generic_message(sender_id, elements)

	def state_60(self,sender_id, name):
		'''Datos del beneficiario'''
		message = [name+" para poder realizar tu envío te sugerimos tener los siguientes datos a la mano",
				   "Nombre completo de la persona que recibirá el dinero, estado donde vive la persona que recibirá el dinero",
				   "Para comenzar con tu envío, nos puedes proporcionar el nombre completo con el primer y segundo apellido de la persona que recibirá el dinero"]
		self.bot.send_text_message(sender_id, message[0])
		self.bot.send_text_message(sender_id, message[1])
		self.bot.send_text_message(sender_id, message[2])


	def state_63(self, sender_id):
		message = "¿Cuál es el primer y segundo nombre de la persona a la que enviarás?"
		self.bot.send_text_message(sender_id, message)

	def state_64(self, sender_id):
		message = "Gracias ¿Me podrías decir cuál es su apellido paterno?"
		self.bot.send_text_message(sender_id, message)

	def state_65(self, sender_id):
		message = "¿Me ayudas con el apellido materno?"
		self.bot.send_text_message(sender_id, message)

	def state_70(self,sender_id):
		text = "¿A quien enviaremos el dinero?"
		self.bot.send_button_message(sender_id, text, self.buttons['state70'])

	def state_80(self,sender_id, contacts):
		'''Seleccionar beneficiarios frecuentes'''
		#Example constacts
		message = "Selecciona a un beneficiario de tu lista de envíos"
		self.bot.send_text_message(sender_id, message)
		elements = []
		for contact in range(len(contacts)):
			buttons = [{"type":"postback","title":"Seleccionar","payload": "S"+str(contacts[contact]['idBeneficiario'])}, 
					   {"type":"postback","title":"Borrar","payload": "B"+str(contacts[contact]['idBeneficiario'])}]

			element = {"title":contacts[contact]['nombre']+" "+contacts[contact]['apPaterno']+" "+contacts[contact]['apMaterno'],
					  	"image_url":"http://ishowmy.support/img/user-icon-360x360.jpg",
					  	"buttons":buttons}
			elements.append(element)
		self.bot.send_generic_message(sender_id, elements)

	def state_85(self,sender_id):
		text = "Indicanos el estado donde se recibirá el dinero"
		message = "Selecciona un estado de la lista que esta ordenada alfabéticamente"
		self.bot.send_text_message(sender_id,message)
		self.bot.send_quick_replies(sender_id,text,self.replies['state85'])

	def state_90(self,sender_id, recipient_name):
		'''Monto'''	
		text = "¿Cuánto quieres enviarle? a "+recipient_name
		self.bot.send_quick_replies(sender_id,text,self.replies['state90'])

	def state_110(self,sender_id, name):
		'''Datos del usuario'''
		message = "Hola "+name+", Por favor proporcionanos tu nombre completo con primer y segundo apellido"
		self.bot.send_text_message(sender_id, message)

	def state_113(self, sender_id):
		message = "¿Cuál es tu primer y segundo nombre?"
		self.bot.send_text_message(sender_id, message)

	def state_114(self, sender_id):
		message = "Gracias ¿Me podrías decir cuál es tu apellido paterno?"
		self.bot.send_text_message(sender_id, message)

	def state_115(self, sender_id):
		message = "¿Me ayudas con tu apellido materno?"
		self.bot.send_text_message(sender_id, message)

	def state_120(self,sender_id, name):
		'''Corregir fecha de nacimiento'''
		message = name+", Ahora podrías decirnos cúal es tu fecha de nacimiento, te sugerimos el siguiente formato"
		self.bot.send_text_message(sender_id, message)
		message = "Ahora podrías decirnos cúal es tu fecha de nacimiento, te sugerimos el siguiente formato de ejemplo" 
		self.bot.send_text_message(sender_id, message)
		message = "12 de abril de 1987"
		self.bot.send_text_message(sender_id,message)

	def state_130(self,sender_id, name):
		'''Domicilio usuario'''
		message = "Compartenos la calle, número colonia y código postal de donde vives"
		self.bot.send_text_message(sender_id, message)

	def state_133(self, sender_id):
		message = "¿Cuál es la calle y numero de tu dirección?"
		self.bot.send_text_message(sender_id, message)

	def state_134(self, sender_id,name):
		message = "¿"+name +" me podrias proporcionar la colonia de tu dirección?"
		self.bot.send_text_message(sender_id, message)

	def state_135(self, sender_id):
		message = "Por último tu código postal"
		self.bot.send_text_message(sender_id, message)

	def state_137(self,sender_id):
		message = "Para validar todos los datos necesito una foto de una identificación."
		self.bot.send_text_message(sender_id,message)

	def state_139(self,sender_id,name):
		message = "Gracias"+name+"Por ultimo por la parte posterior de la identicicacion"
		self.bot.send_text_messages(sender_id,message)

	def state_150(self,sender_id, name, recipient_name, quantity, quantityF):
		'''Confirmar datos beneficiario, monto, usuario'''
		message = "Gracias "+name+", elegiste enviar "+str(quantity)+" a "+recipient_name
		self.bot.send_text_message(sender_id, message)
		text = "El costo total de tu envío, incluyendo comisión e IVA es de "+str(quantityF)
		self.bot.send_quick_replies(sender_id,text,self.replies['stateS/N'])

	def state_160(self,sender_id):
		'''Lista negra'''
		message = "Lo siento, no puedo procesar su envío, por favor acuda a una sucursal"
		self.bot.send_text_message(sender_id, message)

	def state_170(self,sender_id, name, image_url):
		'''Notificación activación de código'''
		message = [name+", tu código de envío ha sido activado con éxito",name+", este es tu código de envío"]
		self.bot.send_text_message(sender_id, message[0])
		'''Generar ticket'''
		self.bot.send_text_message(sender_id, message[1])
		print("DESDE REPLICE BOT-------")
		print(image_url)
		self.bot.send_image_url(sender_id, image_url)
		'''Econtrar sucursales cercanas'''
		text = "¿Quieres que te muestre las sucursales más cercanas"
		self.bot.send_quick_replies(sender_id,text,self.replies['state190'])

	def state_180(self,sender_id, places):
		'''Mapa sucursales cercanas'''
		#Example place
		#places = [{'sucursal_name':"Elektra Mega Santo Domingo",'lat':19.3325065,'lon':-99.1735678}]

		message = ["Con esta clave de envío acude a alguna de nuestras sucursales para que pueda ser cobrado por Marina ",
			   	   "Esta clave tiene vigencia antes de la fecha 24 / 05 / 2017",
			   	   "¿Tienes alguna duda?"]

		self.bot.send_text_message(sender_id, message[0])
		elements = []
		for place in range(len(places)):
			element = {"title":places[place]['NameSuc'],
						"subtitle":places[place]['Channel'], 
						"item_url":"https://www.google.com.mx/maps/place/"+str(places[place]['Latitude'])+","+str(places[place]['Longitude']),
					  	"image_url":"http://download.seaicons.com/icons/scafer31000/bubble-circle-3/1024/Maps-icon.png"}
			elements.append(element)
		self.bot.send_generic_message(sender_id, elements)
		self.bot.send_text_message(sender_id, message[1])
		self.bot.send_text_message(sender_id, message[2])
		text = "Necesitas ayuda para a encontrar la sucursal más cercana para pagar el envío?. Compártenos tu ubicación y te mostraremos qué sucursales te quedan más cerca"
		self.bot.send_button_message(sender_id, text, self.buttons['state210'])

	def state_210(self,sender_id):
		'''Mapa sucursales cercanas'''
		message = ["Actívalo en la sucursal Elecktra o Banco Azteca más cerca de ti",
			   	   "También puedes activarlo con alguno de nuestros socios.\nFarmacias del ahorro, Tiendas Neto, Presta Prenda",
			   	   "¿Tienes alguna duda?"]
		self.bot.send_text_message(sender_id, message[0])
		self.bot.send_text_message(sender_id, message[1])
		self.bot.send_text_message(sender_id, message[2])
		text = "LLámanos o escríbenos un correo electrónico"
		self.bot.send_button_message(sender_id, text, self.buttons['state210'])

	def state_231(self,sender_id, name, name1):
		'''Notificación 1'''
		message = "Hola "+name+", te informo que "+name1+" acaba de cobrar el envío"
		self.bot.send_text_message(sender_id, message)

	def state_232(self,sender_id, name):
		'''Notificación 2'''
		message = "Hola "+name+", te informo que tu envío fue cancelado"
		self.bot.send_text_message(sender_id, message)

	def state_233(self,sender_id, name):
		'''Notificación 3'''
		message = "Hola "+name+", te informo que tu código de envío expiro"
		self.bot.send_text_message(sender_id, message)

	def state_area_1(self,sender_id):
		text = "A - C: "
		self.bot.send_quick_replies(sender_id,text,self.replies['state_area_1'])

	def state_area_2(self,sender_id):
		text = "D - M: "
		self.bot.send_quick_replies(sender_id,text,self.replies['state_area_2'])

	def state_area_3(self,sender_id):
		text = "N - S "
		self.bot.send_quick_replies(sender_id,text,self.replies['state_area_3'])

	def state_area_4(self,sender_id):
		text = "T - Z "
		self.bot.send_quick_replies(sender_id,text,self.replies['state_area_4'])

	def find_elektra_location(self,sender_id):
		message = "Enviame tu ubicación para mostrate sucursales cercanas"
		self.bot.send_text_message(sender_id,message)

	def show_stores(self,sender_id,places):
		elements = []
		for place in range(len(places)):
			element = {"title":places[place]['NameSuc'],
						"subtitle":places[place]['Channel'], 
						"item_url":"https://www.google.com.mx/maps/place/"+str(places[place]['Latitude'])+","+str(places[place]['Longitude']),
					  	"image_url":"http://download.seaicons.com/icons/scafer31000/bubble-circle-3/1024/Maps-icon.png"}
			elements.append(element)
		self.bot.send_generic_message(sender_id, elements)
		text = "LLámanos o escríbenos un correo electrónico"
		self.bot.send_button_message(sender_id, text, self.buttons['state210'])



	"""
	Entrada POST: 
	{'object': 'page', 'entry': [{'id': '1373784059354381', 'time': 1493325382852, 'messaging': [{'sender': {'id': '1208994279223700'}, 'recipient': {'id': '1373784059354381'}, 'timestamp': 1493325382614, 'message': {'mid': 'mid.$cAAS7gCpVJ4Nh4mZL1lbsSExEppHw', 'seq': 284799, 'attachments': [{'title': "Jose Angel's Location", 'url': 'https://l.facebook.com/l.php?u=https%3A%2F%2Fwww.bing.com%2Fmaps%2Fdefault.aspx%3Fv%3D2%26pc%3DFACEBK%26mid%3D8100%26where1%3D19.284789%252C%2B-99.185233%26FORM%3DFBKPL1%26mkt%3Den-US&h=ATPeEWzqQZb_Bz29S-3i0pnREY3AWIMXVXMtCm0ql2_bqTx3agNdiomjJAjq4-ukX4a1gMMjGz65vzZQD6TD_DdH8jC2zsuTP4KxpUURLBmnNwY&s=1&enc=AZOiV7BN3D5L_h2fEubVVqZOhoonp7tFzFZvva868BmmdjODqx6GCmfR83dWsE1zGhxwrfF0MgayZCKC_1OmfzmE', 'type': 'location', 'payload': {'coordinates': {'lat': 19.284789, 'long': -99.185233}}}]}}]}]}

	"""
